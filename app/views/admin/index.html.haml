%ul#catalogue.mdl-shadow--2dp{"data-collapsible":"accordion"}
	- if $categories.size > 0
		- edit_category = "mdl-button mdl-button--colored mdl-js-button mdl-button--fab mdl-button--mini-fab material-icons"
		- edit_item = "mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab material-icons"

		- $categories.each do |category|
			%li{"id": category.index}
				.adaptive_header.collapsible-header
					.title-wrapper
						%i.custom-icons{"style":"background-image: url(\"#{category.icon}\")"}
						= category.label
						= "(Категория спрятана)" unless to_bool(category.visibility)
						
				%section.collapsible-body.mdl-color--grey-850
					- if category.items.size > 0
						- item_classes = "item mdl-shadow--2dp mdl-color--grey-900 call_dialog"

						.owl-carousel.owl-theme.show_items
							- category.items.each do |item|
								%figure{"class":"#{item_classes}", "id":"item_#{item.id}"}
									%a{"href":"/items/#{item.id}", "data-remote":"true", "data-method":"get", "title":"Нажмите для подробной информации"}
										- unless item.thumbnail == nil
											%img.owl-lazy{"data-src":"#{item.thumbnail}"}
										- else
											= image_tag("no_thumbnail.png")
									.buttons-wrapper
										= link_to("delete", "/items/#{item.id}", "title":"Удалить товар", "remote":true, "method":"delete",
											"class":"#{edit_item}", "data-confirm": "Вы уверены, что хотите удалить товар \"#{item.name}\"?")
										= link_to("edit", "/items/#{item.id}/edit", "title":"Редактировать товар",
															"remote":true, "method":"get", "class":"#{edit_item}")
									%figcaption
										%span.name= item.name
										- if item.price.size > 0
											%span.price= item.price.to_s + " ₽"
						%article.no_items.false
							%h4= "Нет в наличии"

					- else
						%article.no_items
							%h4= "Нет в наличии"

					.buttons-wrapper
						= link_to("add", "/items/new","title":"Добавить товар", "remote":true, "method":"get",
											"class":"#{edit_category}","data-params":"categoryId=#{category.id}")
						= link_to("delete", "/categories/#{category.id}", "title":"Удалить категорию", "remote":true, "method":"delete",
											"class":"#{edit_category}", "data-confirm": "Вы уверены, что хотите удалить категорию \"#{category.label}\"?")
						= link_to("edit", "/categories/#{category.id}/edit", "title":"Редактировать категорию",
											"remote":true, "method":"get", "class":"#{edit_category}")

	- else
		.no_categories
			%h4= "База данных категорий пуста"

	.add_category
		- classes = "mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect"
		= link_to("Добавить категорию", "/categories/new", "remote": true, "method": "get", "class":"#{classes}")

